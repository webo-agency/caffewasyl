window.WebARX=window.WebARX||{},function(e,a,r,t){var n={};t.init=function(){t.cache(),t.bindEvents()},t.cache=function(){n.window=r(e),n.body=r(a.body)},t.bindEvents=function(){r("#webarx-bruteforce-checkbox").on("change",function(){var e={action:"activate_deactivate_recaptcha",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):"1"==e?(r("#webarx-widget-status-blue").hide(),r("#webarx-widget-status-red").is(":hidden")&&r("#webarx-widget-status-green").show()):(r("#webarx-widget-status-blue").show(),r("#webarx-widget-status-green").hide())})}),r("#webarx-firewall-checkbox").on("change",function(){var e={action:"activate_deactivate_firewall",WebarxNonce:WebarxVars.nonce};r("#webarx-widget-status-red").is(":visible")?(r("#webarx-widget-status-red").hide(),r("#webarx-widget-status-blue").is(":hidden")&&r("#webarx-widget-status-green").show()):(r("#webarx-widget-status-red").show(),r("#webarx-widget-status-green").hide()),r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):"1"==e?(r("#webarx-widget-status-red").hide(),r("#webarx-widget-status-blue").is(":hidden")&&r("#webarx-widget-status-green").show()):(r("#webarx-widget-status-red").show(),r("#webarx-widget-status-green").hide())})}),r("#webarx-activate-license").on("click",function(){var e=r("#webarx_api_client_id").val(),a=r("#webarx_api_client_secret_key").val(),t={action:"activate_license",clientid:e,secretkey:a,WebarxNonce:WebarxVars.nonce};return 0==r.trim(e).length?(alert("Please enter the API Client ID!"),!1):0==r.trim(a).length?(alert("Please enter the API Client Secret Key!"),!1):void r.post(WebarxVars.ajaxurl,t,function(e){var a=r.parseJSON(e);"error"==a.result?alert(WebarxVars.error_message):(r("#hiddenstatusbox").show(),r("#webarx_license_key_result").text(a.message),r("#webarx-activate-license").hide(),r("#webarx-deactivate-license").show(),r("#webarx-test-api").show())})}),r("#webarx-deactivate-license").on("click",function(){var e=r("#webarx_api_client_id").val(),a=r("#webarx_api_client_secret_key").val(),t={action:"deactivate_license",clientid:e,secretkey:a,WebarxNonce:WebarxVars.nonce};return 0==r.trim(e).length?(alert("Please enter the API Client ID!"),!1):0==r.trim(a).length?(alert("Please enter the API Client Secret Key!"),!1):void r.post(WebarxVars.ajaxurl,t,function(e){var a=r.parseJSON(e);"error"==a.result?alert(WebarxVars.error_message):(r("#hiddenstatusbox").show(),r("#webarx_license_key_result").text(a.message),r("#webarx-activate-license").show(),r("#webarx-deactivate-license").hide(),r("#webarx-test-api").hide())})}),r("#webarx-test-api").on("click",function(){var e={action:"test_api",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){var a=r.parseJSON(e);r("#hiddenstatusbox").show(),"success"==a.result?r("#webarx_license_key_result").text("API connected successfully!"):r("#webarx_license_key_result").text(a.message),r("#webarx-activate-license").hide(),r("#webarx-deactivate-license").show(),r("#webarx-test-api").show()})}),r("#mail_key").on("click",function(){var e={action:"send_mail_key",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):alert("Email Sent!")})}),r("#webarx_send_mail_url").on("click",function(){var e={action:"send_new_url_email",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):alert("Email Sent!")})}),r("#webarx_backup_connect_gdrive").on("click",function(){var a={action:"webarx_backup_authorize_gdrive",url:e.location.href,WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,a,function(a){"fail"==a?alert(WebarxVars.error_message):e.location.href=a.url})}),r("#webarx-backup-create").on("click",function(){var e={action:"webarx_zip_backup",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):(alert("Backup process started, please wait."),r("#webarx-save-backup-settings").prop("disabled",!0),r("#webarx-revert-backup").prop("disabled",!0),r("#webarx-backup-create").prop("disabled",!0),r("#webarx-disable-backups").prop("disabled",!0))})}),r("#webarx-save-backup-settings").on("click",function(){var e={frequency:r("#webarx-backup-frequency").val(),action:"save_backup_settings",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):alert("Backup settings saved successfully.")})}),r("#webarx-revert-backup").on("click",function(){var e={id:r("#webarx-select-backup").val(),action:"webarx_revertBackup",WebarxNonce:WebarxVars.nonce};r.post(WebarxVars.ajaxurl,e,function(e){"fail"==e?alert(WebarxVars.error_message):(alert("Backup process started, please wait."),r("#webarx-save-backup-settings").prop("disabled",!0),r("#webarx-revert-backup").prop("disabled",!0),r("#webarx-backup-create").prop("disabled",!0))})}),r("#file_hashes_page_limit").on("change",function(e){var a={limit:r("#file_hashes_page_limit").val(),action:"file_integrity_change_page_limit",WebarxNonce:WebarxVars.nonce};e.preventDefault(),r.post(WebarxVars.ajaxurl,a,function(e){"fail"==e?alert(WebarxVars.error_message):r(".webarx-file_hashes-table").html(e)})}),r(".webarx-file-hashes-table").on("click",".file_hashes_table_pages",function(e){var a={pageid:r(this).data("page-id"),limit:r("#file_hashes_page_limit").val(),action:"file_integrity_change_page_limit",WebarxNonce:WebarxVars.nonce};e.preventDefault(),r.post(WebarxVars.ajaxurl,a,function(e){"fail"==e?alert(WebarxVars.error_message):r(".webarx-file-hashes-table").html(e)})}),r("#webarx-file-integrity-button").on("click",function(e){var a={limit:r("#file_hashes_page_limit").val(),action:"file_integrity_scan",WebarxNonce:WebarxVars.nonce};e.preventDefault(),r("#webarx-file-integrity-button").attr("value","Please wait ..."),r("#webarx-file-integrity-button").prop("disabled",!0),r("#webarx-file-integrity-cancel-button").show(),r.post(WebarxVars.ajaxurl,a,function(e){"fail"==e?alert(WebarxVars.error_message):r(".webarx-file-hashes-table").html(e),r("#webarx-file-integrity-button").attr("value","File Integrity Check"),r("#webarx-file-integrity-button").prop("disabled",!1)})}),r("#webarx-file-integrity-cancel-button").on("click",function(e){var a={action:"file_integrity_scan_cancle",WebarxNonce:WebarxVars.nonce};e.preventDefault(),r("#webarx-file-integrity-cancel").attr("value","Cancelling Scan ..."),r("#webarx-file-integrity-cancel-button").hide(),r.post(WebarxVars.ajaxurl,a,function(e){"fail"==e?alert(WebarxVars.error_message):r(".webarx-file-hashes-table").html(e),r("#webarx-file-integrity-button").attr("value","File Integrity Check"),r("#webarx-file-integrity-button").prop("disabled",!1),r("#webarx-file-integrity-cancel-button").hide()})}),r("#webarx_close_banner").on("click",function(){a.cookie="webarx_banner_close=true; path=/;",r(".webarx-banner").hide()}),r(".webarx_firewall_legend").on("click",function(){r("#webarx-firewall-legend-table").is(":hidden")?r("#webarx-firewall-legend-table").show():r("#webarx-firewall-legend-table").hide()}),void 0!==jQuery.fn.dataTable&&-1!==e.location.href.indexOf("webarx")&&(r(".table-firewall-log").DataTable({processing:!0,serverSide:!0,ajax:{url:WebarxVars.ajaxurl,type:"POST",data:function(e){e.action="firewall_log_table",e.WebarxNonce=r("meta[name=webarx_nonce]").attr("value")}},responsive:!0,columns:[{data:"fid"},{data:"fid"},{data:"referer"},{data:"method"},{data:"ip",render:r.fn.dataTable.render.text()},{data:"log_date"}],order:[[0,"desc"]],searching:!1,ordering:!1,drawCallback:function(e){r(".titletip").tooltip()},columnDefs:[{render:function(e,a,r){for(var t="low",n=["xss","csrf","xsrf"],i=0;i<n.length;i++)-1!==String(r.fid).toLowerCase().indexOf(n[i])&&(t="medium");var s=["sqli","lfi","rfe","id","files"];for(i=0;i<s.length;i++)-1!==String(r.fid).toLowerCase().indexOf(s[i])&&(t="high");var l="blue";return"medium"===t&&(l="orange"),"high"===t&&(l="red"),'<small style="color: '+l+'">'+t.toUpperCase()+"</small>"},targets:0},{render:function(e,a,r){var t=e||"Unknown";return'<span class=" titletip" title="'+(r.description?r.description:"No Explanation")+'">'+t+"</span>"},targets:1},{render:function(e,a,r){return decodeURIComponent(e).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace("+"," ")},targets:[2]}]}),r(".table-user-log").DataTable({processing:!0,serverSide:!0,ajax:{url:WebarxVars.ajaxurl,type:"POST",data:function(e){e.action="users_log_table",e.WebarxNonce=r("meta[name=webarx_nonce]").attr("value")}},responsive:!0,columns:[{data:"author"},{data:"action",render:r.fn.dataTable.render.text()},{data:"object",render:r.fn.dataTable.render.text()},{data:"object_name",render:r.fn.dataTable.render.text()},{data:"ip",render:r.fn.dataTable.render.text()},{data:"date",render:r.fn.dataTable.render.text()}],order:[[0,"desc"]],searching:!0,ordering:!1,columnDefs:[{render:function(e,a,r){return"18.220.89.14"==r.ip?"WebARX API":e},targets:[0,4]}]}))},r(t.init)}(window,document,jQuery,window.WebARX);